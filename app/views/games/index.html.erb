<div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
  <!-- Last Sync Times -->
  <div style="background: #f5f5f5; border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 8px;">
    <h4 style="margin: 0 0 10px 0; color: #333;">Last Sync Times</h4>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 14px;">
      <div>
        <strong style="color: #d32f2f;">Live Games (1 hour window):</strong><br>
        <span style="color: #666;">
          <%= @last_live_sync ? @last_live_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
      <div>
        <strong style="color: #1976d2;">Upcoming (1-48 hours):</strong><br>
        <span style="color: #666;">
          <%= @last_upcoming_sync ? @last_upcoming_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
      <div>
        <strong style="color: #388e3c;">Distant (48+ hours):</strong><br>
        <span style="color: #666;">
          <%= @last_distant_sync ? @last_distant_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
    </div>
  </div>

  <h2 style="margin-bottom: 20px;">Upcoming Games</h2>

  <% if @games_by_sport.empty? %>
    <p style="color: #666; font-style: italic;">No games scheduled at this time.</p>
  <% else %>

    <% @games_by_sport.each do |sport, games| %>
      <!-- Sport Section with Collapsible Control -->
      <div data-controller="collapsible" style="margin-bottom: 20px;">

        <!-- Sport Header (Clickable) -->
        <div class="sport-header" data-action="click->collapsible#toggle">
          <span class="sport-arrow" data-collapsible-target="arrow" aria-expanded="false">â–¶</span>
          <h3 class="sport-title">
            <%= format_sport_name(sport) %>
            <span class="game-count">(<%= games.count %> <%= games.count == 1 ? 'game' : 'games' %>)</span>
          </h3>
        </div>

        <!-- Games Container (Hidden by default) -->
        <div data-collapsible-target="content">
          <% games.each do |game| %>
            <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 20px; border-radius: 8px;">
              <!-- Game Header -->
              <div style="margin-bottom: 15px;">
                <h3 style="margin: 0;">
                  <%= game.away_team.city %> <%= game.away_team.name %>
                  @
                  <%= game.home_team.city %> <%= game.home_team.name %>
                </h3>
                <p style="color: #666; margin: 5px 0;">
                  <%= format_sport_name(game.sport) %> |
                  <%= game.game_time.strftime("%A, %B %d at %I:%M %p %Z") %> |
                  Status: <%= game.status.capitalize %>
                </p>
              </div>

              <!-- Betting Lines -->
              <h4>Betting Lines:</h4>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">

                <% game.betting_lines.each do |line| %>
                  <div style="border: 1px solid #eee; padding: 10px; border-radius: 4px; background: #f9f9f9;">
                    <strong style="display: block; margin-bottom: 8px; text-transform: uppercase;">
                      <%= line.line_type.gsub('_', ' ') %>
                    </strong>

                    <% if line.line_type == 'moneyline' %>
                      <div>
                        <%= game.home_team.abbreviation %>: <%= line.home_odds > 0 ? "+#{line.home_odds.to_i}" : line.home_odds.to_i %>
                      </div>
                      <div>
                        <%= game.away_team.abbreviation %>: <%= line.away_odds > 0 ? "+#{line.away_odds.to_i}" : line.away_odds.to_i %>
                      </div>

                    <% elsif line.line_type == 'spread' %>
                      <div>
                        <%= game.home_team.abbreviation %> <%= line.spread > 0 ? "+#{line.spread}" : line.spread %>
                        (<%= line.home_odds.to_i %>)
                      </div>
                      <div>
                        <%= game.away_team.abbreviation %> <%= line.spread < 0 ? "+#{-line.spread}" : -line.spread %>
                        (<%= line.away_odds.to_i %>)
                      </div>

                    <% elsif line.line_type == 'over_under' %>
                      <div>Over <%= line.total %>: <%= line.over_odds.to_i %></div>
                      <div>Under <%= line.total %>: <%= line.under_odds.to_i %></div>
                    <% end %>
                  </div>
                <% end %>

              </div>
            </div>
          <% end %>
        </div>

      </div>
    <% end %>

  <% end %>
</div>
