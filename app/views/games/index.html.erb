<div class="w-full">
  <!-- Last Sync Times - Mobile First with better padding -->
  <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 sm:p-5 md:p-6 shadow-sm" style="margin-bottom: 1.5rem;">
    <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-4">Last Sync Times</h4>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 text-sm" style="gap: 1rem;">
      <div class="bg-white p-4 rounded-md shadow-sm">
        <strong class="text-red-600 block mb-2">Live Games (1 hour window):</strong>
        <span class="text-gray-600">
          <%= @last_live_sync ? @last_live_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
      <div class="bg-white p-4 rounded-md shadow-sm">
        <strong class="text-blue-600 block mb-2">Upcoming (1-48 hours):</strong>
        <span class="text-gray-600">
          <%= @last_upcoming_sync ? @last_upcoming_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
      <div class="bg-white p-4 rounded-md shadow-sm sm:col-span-2 lg:col-span-1">
        <strong class="text-green-600 block mb-2">Distant (48+ hours):</strong>
        <span class="text-gray-600">
          <%= @last_distant_sync ? @last_distant_sync.strftime("%b %d at %I:%M %p") : "Never synced" %>
        </span>
      </div>
    </div>
  </div>

  <h2 class="text-2xl sm:text-3xl font-bold text-gray-800" style="margin-top: 1.5rem; margin-bottom: 1.5rem;">Upcoming Games</h2>

  <% if @games_by_sport.empty? %>
    <p class="text-gray-600 italic text-center py-8">No games scheduled at this time.</p>
  <% else %>

    <% @games_by_sport.each do |sport, games| %>
      <!-- Sport Section with Collapsible Control - Mobile First -->
      <div data-controller="collapsible" style="margin-bottom: 2rem;">

        <!-- Sport Header (Clickable) - Responsive with better padding -->
        <div class="flex items-center p-4 sm:p-5 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer select-none hover:bg-gray-200 transition-colors duration-200"
             data-action="click->collapsible#toggle">
          <span class="inline-block mr-3 sm:mr-4 text-xs sm:text-sm text-gray-600 transition-transform duration-300"
                data-collapsible-target="arrow"
                aria-expanded="false">â–¶</span>
          <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-gray-800 m-0">
            <%= format_sport_name(sport) %>
            <span class="text-sm sm:text-base font-normal text-gray-600 ml-2 sm:ml-3">
              (<%= games.count %> <%= games.count == 1 ? 'game' : 'games' %>)
            </span>
          </h3>
        </div>

        <!-- Games Container (Hidden by default) - Responsive spacing -->
        <div data-collapsible-target="content">
          <% games.each do |game| %>
            <div class="border border-gray-300 rounded-lg p-5 sm:p-6 md:p-7 bg-white shadow-sm hover:shadow-md transition-shadow duration-200" style="margin-top: 1.25rem;">
              <!-- Game Header - Stack on mobile, single line on desktop with better spacing -->
              <div class="mb-5 sm:mb-6">
                <h3 class="text-base sm:text-lg md:text-xl font-semibold text-gray-800 mb-3">
                  <span class="block sm:inline"><%= game.away_team.city %> <%= game.away_team.name %></span>
                  <span class="text-gray-500 mx-2 hidden sm:inline">@</span>
                  <span class="block sm:inline mt-2 sm:mt-0"><%= game.home_team.city %> <%= game.home_team.name %></span>
                </h3>
                <p class="text-xs sm:text-sm text-gray-600 space-y-1 sm:space-y-0">
                  <span class="block sm:inline"><%= format_sport_name(game.sport) %></span>
                  <span class="hidden sm:inline text-gray-400 mx-1"> | </span>
                  <span class="block sm:inline mt-1 sm:mt-0"><%= game.game_time.strftime("%A, %B %d at %I:%M %p %Z") %></span>
                  <span class="hidden sm:inline text-gray-400 mx-1"> | </span>
                  <span class="block sm:inline mt-1 sm:mt-0">Status: <span class="font-medium"><%= game.status.capitalize %></span></span>
                </p>
              </div>

              <!-- Betting Lines - Mobile first grid with better spacing -->
              <h4 class="text-sm sm:text-base font-semibold text-gray-700 mb-4">Betting Lines:</h4>
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3" style="gap: 1.25rem;">

                <% game.betting_lines.each do |line| %>
                  <div class="border border-gray-200 rounded-lg p-4 sm:p-5 bg-gray-50 hover:bg-gray-100 transition-colors duration-150">
                    <strong class="block mb-3 text-xs sm:text-sm font-bold uppercase tracking-wide text-gray-700">
                      <%= line.line_type.gsub('_', ' ') %>
                    </strong>

                    <% if line.line_type == 'moneyline' %>
                      <div class="text-sm sm:text-base space-y-2">
                        <div class="flex justify-between items-center">
                          <span class="font-medium"><%= game.home_team.abbreviation %>:</span>
                          <span class="<%= line.home_odds < 0 ? 'text-red-600' : 'text-green-600' %> font-semibold">
                            <%= line.home_odds > 0 ? "+#{line.home_odds.to_i}" : line.home_odds.to_i %>
                          </span>
                        </div>
                        <div class="flex justify-between items-center">
                          <span class="font-medium"><%= game.away_team.abbreviation %>:</span>
                          <span class="<%= line.away_odds < 0 ? 'text-red-600' : 'text-green-600' %> font-semibold">
                            <%= line.away_odds > 0 ? "+#{line.away_odds.to_i}" : line.away_odds.to_i %>
                          </span>
                        </div>
                      </div>

                    <% elsif line.line_type == 'spread' %>
                      <div class="text-sm sm:text-base space-y-2">
                        <div class="flex justify-between items-center">
                          <span class="font-medium"><%= game.home_team.abbreviation %> <%= line.spread > 0 ? "+#{line.spread}" : line.spread %></span>
                          <span class="text-gray-700">(<%= line.home_odds.to_i %>)</span>
                        </div>
                        <div class="flex justify-between items-center">
                          <span class="font-medium"><%= game.away_team.abbreviation %> <%= line.spread < 0 ? "+#{-line.spread}" : -line.spread %></span>
                          <span class="text-gray-700">(<%= line.away_odds.to_i %>)</span>
                        </div>
                      </div>

                    <% elsif line.line_type == 'over_under' %>
                      <div class="text-sm sm:text-base space-y-2">
                        <div class="flex justify-between items-center">
                          <span class="font-medium">Over <%= line.total %>:</span>
                          <span class="text-gray-700 font-semibold"><%= line.over_odds.to_i %></span>
                        </div>
                        <div class="flex justify-between items-center">
                          <span class="font-medium">Under <%= line.total %>:</span>
                          <span class="text-gray-700 font-semibold"><%= line.under_odds.to_i %></span>
                        </div>
                      </div>
                    <% end %>
                  </div>
                <% end %>

              </div>
            </div>
          <% end %>
        </div>

      </div>
    <% end %>

  <% end %>
</div>
